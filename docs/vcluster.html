

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>13. Virtual Cluster &mdash; cm4 alpha documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="14. VM Description" href="vm.html" />
    <link rel="prev" title="12. CM4 REST Api" href="ufo.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> cm4
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">1. About</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributors.html">2. Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">3. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">4. Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="mongo.html">5. Cloudmesh Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">6. Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="vmproviders.html">7. VM Providers</a></li>
<li class="toctree-l1"><a class="reference internal" href="vagrant.html">8. Vagrant</a></li>
<li class="toctree-l1"><a class="reference internal" href="CM4README.html">9. CM4 Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html">10. Cloudmesh cm v4</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws.html">11. AWS cm</a></li>
<li class="toctree-l1"><a class="reference internal" href="ufo.html">12. CM4 REST Api</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">13. Virtual Cluster</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-virtual-cluster-and-testing-connections">13.1. Creating a Virtual Cluster and testing connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-runtime-configuration">13.2. Creating a runtime-configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-parallel-remote-jobs">13.3. Running Parallel Remote Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cleaning-the-remote">13.4. Cleaning the remote</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vm.html">14. VM Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="jupyter.html">15. Jupyter Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual.html">16. Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual-dev.html">17. Manual - Dev</a></li>
<li class="toctree-l1"><a class="reference internal" href="code.html">18. Code Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">cm4</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>13. Virtual Cluster</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/vcluster.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="virtual-cluster">
<span id="virtual-cluster"></span><h1>13. Virtual Cluster<a class="headerlink" href="#virtual-cluster" title="Permalink to this headline">¶</a></h1>
<p>This is a tool used to submit jobs to remote hosts in parallel and contains the following subcommands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cms vcluster create virtual-cluster VIRTUALCLUSTER_NAME --clusters=CLUSTERS_LIST [--computers=COMPUTERS_LIST] [--debug]</span>
<span class="go">cms vcluster destroy virtual-cluster VIRTUALCLUSTER_NAME</span>
<span class="go">cms vcluster create runtime-config CONFIG_NAME PROCESS_NUM in:params out:stdout [--fetch-proc-num=FETCH_PROCESS_NUM [default=1]] [--download-now [default=True]]  [--debug]</span>
<span class="go">cms vcluster create runtime-config CONFIG_NAME PROCESS_NUM in:params out:file [--fetch-proc-num=FETCH_PROCESS_NUM [default=1]] [--download-now [default=True]]  [--debug]</span>
<span class="go">cms vcluster create runtime-config CONFIG_NAME PROCESS_NUM in:params+file out:stdout [--fetch-proc-num=FETCH_PROCESS_NUM [default=1]]  [--download-now [default=True]]  [--debug]</span>
<span class="go">cms vcluster create runtime-config CONFIG_NAME PROCESS_NUM in:params+file out:file [--fetch-proc-num=FETCH_PROCESS_NUM [default=1]] [--download-now [default=True]]  [--debug]</span>
<span class="go">cms vcluster create runtime-config CONFIG_NAME PROCESS_NUM in:params+file out:stdout+file [--fetch-proc-num=FETCH_PROCESS_NUM [default=1]] [--download-now [default=True]]  [--debug]</span>
<span class="go">cms vcluster set-param runtime-config CONFIG_NAME PARAMETER VALUE</span>
<span class="go">cms vcluster destroy runtime-config CONFIG_NAME</span>
<span class="go">cms vcluster list virtual-clusters [DEPTH [default:1]]</span>
<span class="go">cms vcluster list runtime-configs [DEPTH [default:1]]</span>
<span class="go">cms vcluster run-script --script-path=SCRIPT_PATH --job-name=JOB_NAME --vcluster-name=VIRTUALCLUSTER_NAME --config-name=CONFIG_NAME --arguments=SET_OF_PARAMS --remote-path=REMOTE_PATH&gt; --local-path=LOCAL_PATH [--argfile-path=ARGUMENT_FILE_PATH] [--outfile-name=OUTPUT_FILE_NAME] [--suffix=SUFFIX] [--overwrite]</span>
<span class="go">cms vcluster fetch JOB_NAME</span>
<span class="go">cms vcluster clean-remote JOB_NAME PROCESS_NUM</span>
<span class="go">cms vcluster test-connection VIRTUALCLUSTER_NAME PROCESS_NUM</span>
</pre></div>
</div>
<p>As can be seen, the command <code class="docutils literal notranslate"><span class="pre">vcluster</span></code> can be called with XX possible options:</p>
<ul class="simple">
<li>create<ul>
<li>virtual-cluster</li>
<li>runtime-config</li>
</ul>
</li>
<li>destroy<ul>
<li>virtual-cluster</li>
<li>runtime-config</li>
</ul>
</li>
<li>list<ul>
<li>virtual-clusters</li>
<li>runtime-configs</li>
</ul>
</li>
<li>set-param<ul>
<li>virtual-cluster</li>
<li>runtime-config</li>
</ul>
</li>
<li>run-script</li>
<li>fetch</li>
<li>clean-remote</li>
<li>test-connection</li>
</ul>
<p>The information needed to create a virtual cluster, are extracted from the <code class="docutils literal notranslate"><span class="pre">yaml</span></code> file of the cloudmesh v4, aka <code class="docutils literal notranslate"><span class="pre">cms</span></code>, however, it does not modify that file. Instead, it will create a new configuration file in a folder called <code class="docutils literal notranslate"><span class="pre">vcluster_workspace</span></code>. This newly generate configuration file contains all the information about the virtual clusters, runtime configurations as well as submitted jobs and therefore the file is crucial for fetching the result of the previous runs. Although possible, it is highly recommended not to modify the file directly but instead use the <code class="docutils literal notranslate"><span class="pre">set-param</span></code> command to modify the file.</p>
<p>When you are creating a virtual cluster, you can <em>pick</em> your nodes of interest from the cloudmesh configuration and just pass it as an argument to <code class="docutils literal notranslate"><span class="pre">create</span> <span class="pre">virtual-cluster</span></code>  and you will have your <em>Virtual Cluster</em> created this way. When you are done with a Virtual Cluster, aka <code class="docutils literal notranslate"><span class="pre">vcluster</span></code>, you can simply destroy it.</p>
<div class="section" id="creating-a-virtual-cluster-and-testing-connections">
<span id="creating-a-virtual-cluster-and-testing-connections"></span><h2>13.1. Creating a Virtual Cluster and testing connections<a class="headerlink" href="#creating-a-virtual-cluster-and-testing-connections" title="Permalink to this headline">¶</a></h2>
<p>Consider the following two dummy clusters in the <code class="docutils literal notranslate"><span class="pre">cloudmesh4.yaml</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">cloudmesh</span><span class="p">:</span> 
    <span class="l l-Scalar l-Scalar-Plain">...</span>
    <span class="l l-Scalar l-Scalar-Plain">vcluster_test1</span><span class="p p-Indicator">:</span>
      <span class="nt">computer_a</span><span class="p">:</span>
        <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">machine1</span>
        <span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">one</span>
        <span class="nt">address</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">localhost</span>
        <span class="nt">credentials</span><span class="p">:</span>
          <span class="nt">sshconfigpath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">~/vms/ubuntu14/sshconfig1</span>
      <span class="nt">computer_b</span><span class="p">:</span>
        <span class="nt">name</span><span class="p">:</span>                       <span class="l l-Scalar l-Scalar-Plain">computer_a</span>
        <span class="nt">label</span><span class="p">:</span>                      <span class="l l-Scalar l-Scalar-Plain">one</span>
        <span class="nt">address</span><span class="p">:</span>                    <span class="l l-Scalar l-Scalar-Plain">localhost</span>
        <span class="nt">credentials</span><span class="p">:</span>
          <span class="nt">username</span><span class="p">:</span>                 <span class="l l-Scalar l-Scalar-Plain">TBD</span>
          <span class="nt">pulickey</span><span class="p">:</span>                 <span class="l l-Scalar l-Scalar-Plain">~/.ssh/id_rsa.pub</span>
    <span class="nt">vcluster_test2</span><span class="p">:</span>
      <span class="nt">c2</span><span class="p">:</span>
        <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">machine2</span>
        <span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">two</span>
        <span class="nt">address</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">localhost</span>
        <span class="nt">credentials</span><span class="p">:</span>
          <span class="nt">sshconfigpath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">~/vms/ubuntu14/sshconfig2</span>
    <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
<p>Suppose you want to create a virtual cluster called <code class="docutils literal notranslate"><span class="pre">new_vcluster</span></code> using <code class="docutils literal notranslate"><span class="pre">computer_a</span></code> from <code class="docutils literal notranslate"><span class="pre">vcluster_test1</span></code> and <code class="docutils literal notranslate"><span class="pre">c2</span></code> from <code class="docutils literal notranslate"><span class="pre">vcluster_test2</span></code>. This can be achieved using the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cms vcluster create virtual-cluster vcluster1 --clusters<span class="o">=</span>vcluster_test1,vcluster_test2 --computers<span class="o">=</span>computer_a,c2
<span class="go">Virtual cluster created/replaced successfully.</span>
</pre></div>
</div>
<p>This command will create the <code class="docutils literal notranslate"><span class="pre">vcluster.yaml</span></code> file in the <code class="docutils literal notranslate"><span class="pre">vcluster_workspace</span></code> folder and will keep the information about the virtual cluster in there. Now, we can get the information about the virtual cluster that we just created:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cms vcluster list virtual-clusters
<span class="go"> vcluster1:</span>
<span class="go">     computer_a</span>
<span class="go">     c2</span>
</pre></div>
</div>
<p>By passing a depth higher than one as an extra argument, you can get more information about the virtual clusters:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cms vcluster list virtual-clusters <span class="m">2</span>
<span class="go"> vcluster1:</span>
<span class="go">     computer_a:</span>
<span class="go">         name:</span>
<span class="go">             machine1</span>
<span class="go">         label:</span>
<span class="go">             one</span>
<span class="go">         address:</span>
<span class="go">             localhost</span>
<span class="go">         credentials:</span>
<span class="go">             sshconfigpath</span>
<span class="go">     c2:</span>
<span class="go">         name:</span>
<span class="go">             machine2</span>
<span class="go">         label:</span>
<span class="go">             two</span>
<span class="go">         address:</span>
<span class="go">             localhost</span>
<span class="go">         credentials:</span>
<span class="go">             sshconfigpath</span>
</pre></div>
</div>
<p>Now that the virtual cluster is created, we can test the connection to the remote nodes. We will try that using 2 processes in parallel:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cms vcluster test-connection vcluster1 <span class="m">2</span>
<span class="go">Node computer_a is accessible.</span>
<span class="go">Node c2 is accessible.</span>
</pre></div>
</div>
<p>The output indicates that both nodes in the <code class="docutils literal notranslate"><span class="pre">vcluster1</span></code> are accessible. In case you did not need the <code class="docutils literal notranslate"><span class="pre">vcluster1</span></code> anymore, you can easily remove it using:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cms vcluster destroy virtual-cluster vcluster1
<span class="go">Virtual-cluster vcluster1 destroyed successfully.</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-a-runtime-configuration">
<span id="creating-a-runtime-configuration"></span><h2>13.2. Creating a runtime-configuration<a class="headerlink" href="#creating-a-runtime-configuration" title="Permalink to this headline">¶</a></h2>
<p>Next, we have to create a <code class="docutils literal notranslate"><span class="pre">runtime-configuration</span></code> which defines the type of input and output for possibly a set of jobs that are going to be submitted later.  In the next example we will create a runtime configuration for jobs that we want to run remotely using 5 processes, fetch their results using 3 processes and the script that we want to run remotely takes just some parameter (which could be left empty for no parameters), and the output of the script is going to be printed on the standard output, and suppose we want to just submit the jobs for running on remote nodes and download them later (hence the <code class="docutils literal notranslate"><span class="pre">--download-later</span></code> flag):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cms vcluster create runtime-config ParamInStdOut <span class="m">5</span> in:params out:stdout --fetch-proc-num<span class="o">=</span><span class="m">3</span> --download-later
<span class="go">Runtime-configuration created/replaced successfully.</span>
</pre></div>
</div>
<p>Let’s get the list of runtime configurations to make sure our configuration is created as we expected:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cms vcluster list runtime-configs <span class="m">2</span>
<span class="go"> ParamInStdOut:</span>
<span class="go">     proc_num:</span>
<span class="go">         5</span>
<span class="go">     download_proc_num:</span>
<span class="go">         1</span>
<span class="go">     download-later:</span>
<span class="go">         False</span>
<span class="go">     input-type:</span>
<span class="go">         params</span>
<span class="go">     output-type:</span>
<span class="go">         stdout</span>
</pre></div>
</div>
<p>Similar to the virtual cluster, you can remove a runtime-configuration using the <code class="docutils literal notranslate"><span class="pre">destroy</span></code> sub-command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cms vcluster destroy runtime-config ParamInStdOut
<span class="go">Runtime-configuration ParamInStdOut destroyed successfully.</span>
</pre></div>
</div>
</div>
<div class="section" id="running-parallel-remote-jobs">
<span id="running-parallel-remote-jobs"></span><h2>13.3. Running Parallel Remote Jobs<a class="headerlink" href="#running-parallel-remote-jobs" title="Permalink to this headline">¶</a></h2>
<p>Now that we have both the virtual cluster and runtime configuration ready, we can try to submit a batch job to our virtual cluster using <code class="docutils literal notranslate"><span class="pre">cms</span> <span class="pre">vcluster</span> <span class="pre">run-script</span></code>. This is by far the most complicated sub-command of the <code class="docutils literal notranslate"><span class="pre">vcluster</span></code>, however, the name of the arguments are pretty clear and looking at the names you would be able to pretty much find your way. In the next example, we submit the <code class="docutils literal notranslate"><span class="pre">inf_script_stdin_stdout.sh</span></code> file to the nodes of <code class="docutils literal notranslate"><span class="pre">vcluster1</span></code> and using the <code class="docutils literal notranslate"><span class="pre">ParamInStdOut</span></code> configuration we run 10 instance of that script on the virtual cluster. This script will be copied and run on the home directory of the remote nodes (<code class="docutils literal notranslate"><span class="pre">~/</span></code>).  Note that even though the remote path is set to home directory, for each job a folder with a unique suffix will be created to avoid conflicts. Also, note that this script does not take any argument, but we indicated 10 <code class="docutils literal notranslate"><span class="pre">_</span></code> separated by commas as a meaningless argument. This will notify the tool that you need 10 instances of this script to be executed:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cms vcluster run-script --script-path<span class="o">=</span>./cm4/vcluster/sample_scripts/inf_script_stdin_stdout.sh --job-name<span class="o">=</span>TestJob1 --vcluster-name<span class="o">=</span>vcluster1 --config-name<span class="o">=</span>ParamInStdOut --arguments<span class="o">=</span>_,_,_,_,_,_,_,_,_,_ --remote-path<span class="o">=</span>~/ --local-path<span class="o">=</span>./cm4/vcluster/sample_output --overwrite
<span class="go">Remote Pid on c2: 10104</span>
<span class="go">Remote Pid on c2: 10109</span>
<span class="go">Remote Pid on c2: 10402</span>
<span class="go">Remote Pid on computer_a: 8973</span>
<span class="go">Remote Pid on computer_a: 8979</span>
<span class="go">Remote Pid on computer_a: 8983</span>
<span class="go">Remote Pid on computer_a: 9464</span>
<span class="go">Remote Pid on c2: 10884</span>
<span class="go">Remote Pid on c2: 10993</span>
<span class="go">Remote Pid on computer_a: 9592</span>
<span class="go">collecting results</span>
<span class="go">waiting for other results if any...</span>
<span class="go">Results collected from c2.</span>
<span class="go">Results collected from c2.</span>
<span class="go">Results collected from c2.</span>
<span class="go">Results collected from computer_a.</span>
<span class="go">Results collected from computer_a.</span>
<span class="go">Results collected from computer_a.</span>
<span class="go">Results collected from computer_a.</span>
<span class="go">Results collected from c2.</span>
<span class="go">Results collected from c2.</span>
<span class="go">Results collected from computer_a.</span>
<span class="go">waiting for other results if any...</span>
<span class="go">All of the remote results collected.</span>
</pre></div>
</div>
<p>As you can see all of the jobs were submitted (using 5 processes) and results were collected afterwards (using 3 processes). We can check the existence of the results:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ll ./cm4/vcluster/sample_output/
<span class="go">total 48</span>
<span class="go">drwxr-xr-x 2 corriel 4096 Oct 31 22:12 ./</span>
<span class="go">drwxr-xr-x 8 corriel 4096 Oct 31 22:12 ../</span>
<span class="go">-rw-r--r-- 1 corriel  255 Oct 31 22:12 outputfile_0_20181031_22123465</span>
<span class="go">-rw-r--r-- 1 corriel  255 Oct 31 22:12 outputfile_1_20181031_22123465</span>
<span class="go">-rw-r--r-- 1 corriel  255 Oct 31 22:12 outputfile_2_20181031_22123465</span>
<span class="go">-rw-r--r-- 1 corriel  255 Oct 31 22:12 outputfile_3_20181031_22123465</span>
<span class="go">-rw-r--r-- 1 corriel  255 Oct 31 22:12 outputfile_4_20181031_22123465</span>
<span class="go">-rw-r--r-- 1 corriel  255 Oct 31 22:12 outputfile_5_20181031_22123465</span>
<span class="go">-rw-r--r-- 1 corriel  255 Oct 31 22:12 outputfile_6_20181031_22123465</span>
<span class="go">-rw-r--r-- 1 corriel  255 Oct 31 22:12 outputfile_7_20181031_22123465</span>
<span class="go">-rw-r--r-- 1 corriel  255 Oct 31 22:12 outputfile_8_20181031_22123465</span>
<span class="go">-rw-r--r-- 1 corriel  255 Oct 31 22:12 outputfile_9_20181031_22123465</span>
</pre></div>
</div>
<p>Now, suppose the jobs were going to take so long that we could not wait for the results and we had to download them later. To prepare this scenario, we can set the <code class="docutils literal notranslate"><span class="pre">download-later</span></code> attribute of the runtime configuration to <code class="docutils literal notranslate"><span class="pre">true</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cms vcluster set-param runtime-config ParamInStdOut download-later <span class="nb">true</span>
<span class="go">Runtime-configuration parameter download-later set to true successfully.</span>
</pre></div>
</div>
<p>Now that we set this parameter, we can submit the jobs and this time the tool will not wait for the results:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cms vcluster run-script --script-path<span class="o">=</span>./cm4/vcluster/sample_scripts/inf_script_stdin_stdout.sh --job-name<span class="o">=</span>TestJob1 --vcluster-name<span class="o">=</span>vcluster1 --config-name<span class="o">=</span>ParamInStdOut --arguments<span class="o">=</span>_,_,_,_,_,_,_,_,_,_ --remote-path<span class="o">=</span>~/ --local-path<span class="o">=</span>./cm4/vcluster/sample_output --overwrite
<span class="go">Remote Pid on c2: 12981</span>
<span class="go">Remote Pid on c2: 12987</span>
<span class="go">Remote Pid on c2: 13280</span>
<span class="go">Remote Pid on computer_a: 11858</span>
<span class="go">Remote Pid on computer_a: 11942</span>
<span class="go">Remote Pid on computer_a: 11945</span>
<span class="go">Remote Pid on computer_a: 12300</span>
<span class="go">Remote Pid on c2: 13795</span>
<span class="go">Remote Pid on computer_a: 12427</span>
<span class="go">Remote Pid on c2: 13871</span>
</pre></div>
</div>
<p>As you can see, the jobs are submitted and the script is finished. Note that since a job with that exact job name exists, you cannot submit the job unless you use the <code class="docutils literal notranslate"><span class="pre">--overwrite</span></code> flag. Now that we have submitted the jobs and their results are ready, we can fetch their produced results using the <code class="docutils literal notranslate"><span class="pre">fetch</span></code> command and all results will be collected using the same number of processes that were indicated in the runtime-configuration using which the job was submitted in the first place:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cms vcluster fetch TestJob1
<span class="go">collecting results</span>
<span class="go">Results collected from c2.</span>
<span class="go">Results collected from c2.</span>
<span class="go">Results collected from c2.</span>
<span class="go">Results collected from computer_a.</span>
<span class="go">Results collected from computer_a.</span>
<span class="go">Results collected from computer_a.</span>
<span class="go">Results collected from c2.</span>
<span class="go">Results collected from computer_a.</span>
<span class="go">Results collected from computer_a.</span>
<span class="go">Results collected from c2.</span>
<span class="go">waiting for other results if any...</span>
<span class="go">All of the remote results collected.</span>
</pre></div>
</div>
</div>
<div class="section" id="cleaning-the-remote">
<span id="cleaning-the-remote"></span><h2>13.4. Cleaning the remote<a class="headerlink" href="#cleaning-the-remote" title="Permalink to this headline">¶</a></h2>
<p>By default the Virtual Cluster tool does not clean the remotes automatically and this task is left to be performed manually since important results might be lose due to mistakes. To clean the remotes, the user has to explicitly use the <code class="docutils literal notranslate"><span class="pre">clean-remote</span></code> command for a specific job and this way only the results of that particular job will be removed from <strong>ALL</strong> remotes using 2 parallel processes:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cms vcluster clean-remote TestJob1 <span class="m">4</span>
<span class="go">Node c2 cleaned successfully.</span>
<span class="go">Node computer_a cleaned successfully.</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="vm.html" class="btn btn-neutral float-right" title="14. VM Description" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ufo.html" class="btn btn-neutral" title="12. CM4 REST Api" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Cloudmesh Community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>